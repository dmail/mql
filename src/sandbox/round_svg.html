<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="data:," />

    <title>Draw corner</title>
    <style>
      canvas {
        image-rendering: pixelated;
      }
    </style>
  </head>
  <body>
    <div id="root" style="position: relative"></div>
    <script type="module" jsenv-type="module/jsx">
      import { render } from "preact";

      // https://stackoverflow.com/questions/10177985/svg-rounded-corner
      // eslint-disable-next-line no-unused-vars
      const Rect = ({ width, height, radius, color }) => {
        const rectangleWidth = width;
        const rectangleHeight = height;

        // eslint-disable-next-line no-unused-vars
        const TopLeftCorner = ({ width, height, radius }) => {
          const strokeWidth = 1;
          const d = [
            `M ${radius}, ${height}`,
            `V ${radius}`,
            `a ${radius},${radius} 0 0 1 ${radius},${radius}`,
            `H ${width}`,
          ];

          return (
            <path
              d={d.join("")}
              fill="none"
              stroke={color}
              stroke-width={strokeWidth}
            />
          );
        };

        // eslint-disable-next-line no-unused-vars
        const TopRightCorner = ({
          x = 0,
          y = 0,
          width,
          height,
          size,
          radius,
          color,
        }) => {
          let d;
          if (radius <= 0) {
            d = [
              `M ${rectangleWidth - width - x},${y + size / 2}`,
              `h ${width}`,
              `M ${rectangleWidth - size / 2 - x},${y + size}`,
              `v ${height - size}`,
            ];
          } else {
            d = [
              `M ${rectangleWidth - width - x},${y + size / 2}`,
              `h ${width - size / 2 - radius}`,
              `a ${radius},${radius} 0 0 1 ${radius},${radius}`,
              `v ${height - size / 2 - radius}`,
            ];
          }

          return (
            <path
              d={d.join(" ")}
              fill="none"
              stroke={color}
              stroke-width={size}
            />
          );
        };

        const outerSize = 20;
        const innerSize = 10;
        const lastSize = 5;
        const outerRadius = radius;
        const innerRadius = outerRadius - outerSize / 2 - innerSize / 2;
        const lastRadius = innerRadius - innerSize / 2 - lastSize / 2;
        const outerWidth = width / 2;
        const innerWidth = outerWidth - outerSize;
        const lastWidth = innerWidth - innerSize;
        const outerHeight = height / 2;
        const innerHeight = outerHeight - outerSize;
        const lastHeight = innerHeight - innerSize;

        return (
          <>
            <TopRightCorner
              width={outerWidth}
              height={outerHeight}
              radius={outerRadius}
              size={outerSize}
              color={color}
            />
            <TopRightCorner
              x={outerSize}
              y={outerSize}
              width={innerWidth}
              height={innerHeight}
              radius={innerRadius}
              size={innerSize}
              color="red"
            />
            <TopRightCorner
              x={outerSize + innerSize}
              y={outerSize + innerSize}
              width={lastWidth}
              height={lastHeight}
              radius={lastRadius}
              size={lastSize}
              color="green"
            />
          </>
        );
      };

      // eslint-disable-next-line no-unused-vars
      const App = () => {
        return (
          <svg
            width={500}
            height={500}
            style={{
              position: "absolute",
            }}
          >
            <Rect width={500} height={500} radius={5} color="blue"></Rect>
          </svg>
        );
      };

      render(<App />, document.querySelector("#root"));
    </script>
  </body>
</html>
